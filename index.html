<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Display Google Sheet Data in HTML Table with Search</title>
</head>
<body>
  <label for="search-input">Search:</label>
  <input type="text" id="search-input">
  <button id="search-button">Search</button>
  <table id="data-table">
    <thead>
    </thead>
    <tbody>
    </tbody>
  </table>

  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    function displayData(searchQuery) {
      gapi.client.init({
        apiKey: 'AIzaSyBC1g--O8w-o2s3GyPVpKstNc7HanOXR6w'
      }).then(function() {
        return gapi.client.request({
          path: 'https://sheets.googleapis.com/v4/spreadsheets/1RWWNh9Q7W1Xh179uvzG0IVu2Tzwu-4Nf3R4Pu26JR_0/values/Sheet1!A1:C10',
        });
      }).then(function(response) {
        var values = response.result.values;
        var tbody = document.querySelector('#data-table tbody');
        tbody.innerHTML = '';

        for (var i = 0; i < values.length; i++) {
          if (searchQuery && values[i].indexOf(searchQuery) === -1) {
            continue;
          }

          var row = document.createElement('tr');

          for (var j = 0; j < values[i].length; j++) {
            var cell = document.createElement('td');
            cell.textContent = values[i][j];
            row.appendChild(cell);
          }

          tbody.appendChild(row);
        }
      }, function(reason) {
        console.error('Error: ' + reason.result.error.message);
      });
    }

    var searchInput = document.querySelector('#search-input');
    var searchButton = document.querySelector('#search-button');

    searchButton.addEventListener('click', function() {
      var searchQuery = searchInput.value.trim().toLowerCase();
      displayData(searchQuery);
    });

    gapi.load('client', displayData);
  </script>
</body>
</html>
